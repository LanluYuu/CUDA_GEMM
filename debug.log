Gemm version:1
Reference:cublas
Data Type:fp16
Removed exsiting 'build' directory
Created new 'build' directory
-- The CXX compiler identification is GNU 12.3.0
-- The CUDA compiler identification is NVIDIA 12.1.105 with host compiler GNU 12.3.0
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/c++ - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Detecting CUDA compiler ABI info
-- Detecting CUDA compiler ABI info - done
-- Check for working CUDA compiler: /usr/local/cuda/bin/nvcc - skipped
-- Detecting CUDA compile features
-- Detecting CUDA compile features - done
-- Performing Test CMAKE_HAVE_LIBC_PTHREAD
-- Performing Test CMAKE_HAVE_LIBC_PTHREAD - Success
-- Found Threads: TRUE
-- Found CUDA: /usr/local/cuda (found version "12.1")
-- cuda include dirs:/usr/local/cuda/include, ref_cublas.cu
-- Configuring done (2.2s)
-- Generating done (0.0s)
-- Build files have been written to: /root/haojiachen/code/Cuda_Learn/GEMM/build

cmake -DK_VERSION='1' -DREF_TYPE='cublas' -DDATA_TYPE='fp16' -DSOURCE_FILE=gemm_v1.cu -B 'build' .
[ 16%] Building CUDA object CMakeFiles/cudaMatMul.dir/include/d_helper.cu.o
[ 33%] Building CUDA object CMakeFiles/cudaMatMul.dir/ref/ref_cublas.cu.o
[ 50%] Building CUDA object CMakeFiles/cudaMatMul.dir/src/fp16/gemm_v1.cu.o
[ 66%] Linking CUDA static library libcudaMatMul.a
[ 66%] Built target cudaMatMul
[ 83%] Building CUDA object CMakeFiles/main.dir/main.cu.o
[100%] Linking CUDA executable main
[100%] Built target main

init host matirx done
device name:NVIDIA A100-SXM4-80GB

Cublas Execute time:0.615250ms
Cublas Throuphput:223.387175TFLOPS

Mismatch, row:16, col: 128, expected:1012, got:1012.5
Mismatch, row:16, col: 131, expected:1014, got:1014.5
Mismatch, row:16, col: 132, expected:1011, got:1011.5
Mismatch, row:16, col: 134, expected:1027, got:1026
Mismatch, row:16, col: 141, expected:1023, got:1022.5
Mismatch, row:16, col: 142, expected:1005, got:1004.5
Mismatch, row:16, col: 143, expected:1022.5, got:1022
Mismatch, row:16, col: 147, expected:1010, got:1009.5
Mismatch, row:16, col: 149, expected:994, got:993.5
Mismatch, row:16, col: 152, expected:1010, got:1009.5
Mismatch, row:16, col: 154, expected:1021.5, got:1021
Mismatch, row:16, col: 155, expected:1003, got:1002.5
Mismatch, row:16, col: 156, expected:1009, got:1008
Mismatch, row:16, col: 158, expected:1007, got:1006.5
Mismatch, row:16, col: 160, expected:1012, got:1012.5
Mismatch, row:16, col: 163, expected:1012, got:1012.5
Mismatch, row:16, col: 164, expected:1008.5, got:1008
Mismatch, row:16, col: 166, expected:1021, got:1020.5
Mismatch, row:16, col: 168, expected:1021.5, got:1021
Mismatch, row:16, col: 169, expected:1011.5, got:1011
Mismatch, row:16, col: 172, expected:1018.5, got:1019
Mismatch, row:16, col: 174, expected:1007, got:1006.5
Mismatch, row:16, col: 175, expected:1014, got:1014.5
Mismatch, row:16, col: 181, expected:1001.5, got:1001
Mismatch, row:16, col: 184, expected:1017.5, got:1018
Mismatch, row:16, col: 191, expected:1006.5, got:1006
Mismatch, row:16, col: 2177, expected:1013.5, got:1014
Mismatch, row:16, col: 2179, expected:1010.5, got:1011
Mismatch, row:16, col: 2183, expected:1004, got:1004.5
Mismatch, row:16, col: 2184, expected:1010, got:1010.5
Mismatch, row:16, col: 2187, expected:1012.5, got:1013
Mismatch, row:16, col: 2192, expected:1023.5, got:1024
Mismatch, row:16, col: 2195, expected:1007.5, got:1008
Mismatch, row:16, col: 2197, expected:1020.5, got:1021
Mismatch, row:16, col: 2202, expected:1028, got:1029
Mismatch, row:16, col: 2204, expected:1012, got:1012.5
Mismatch, row:16, col: 2205, expected:996.5, got:997
Mismatch, row:16, col: 2206, expected:1009, got:1009.5
Mismatch, row:16, col: 2207, expected:1002, got:1002.5
Mismatch, row:16, col: 2208, expected:1016.5, got:1017
Mismatch, row:16, col: 2211, expected:1022, got:1022.5
Mismatch, row:16, col: 2213, expected:1003.5, got:1004
Mismatch, row:16, col: 2216, expected:989, got:989.5
Mismatch, row:16, col: 2219, expected:1001, got:1001.5
Mismatch, row:16, col: 2220, expected:1010, got:1010.5
Mismatch, row:16, col: 2221, expected:1011.5, got:1012
Mismatch, row:16, col: 2222, expected:1038, got:1039
Mismatch, row:16, col: 2224, expected:1013, got:1013.5
Mismatch, row:16, col: 2229, expected:1022.5, got:1023
Mismatch, row:16, col: 2231, expected:1022.5, got:1023
total mismatch:50

average error:4.34322e-06

compare fail!

Execute time:4.97087ms
Throuphput:27.6488TFLOPS

