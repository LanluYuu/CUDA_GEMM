Gemm version:2
Reference:cublas
Data Type:fp16
Removed exsiting 'build' directory
Created new 'build' directory
-- The CXX compiler identification is GNU 12.3.0
-- The CUDA compiler identification is NVIDIA 12.1.105 with host compiler GNU 12.3.0
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/c++ - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Detecting CUDA compiler ABI info
-- Detecting CUDA compiler ABI info - done
-- Check for working CUDA compiler: /usr/local/cuda/bin/nvcc - skipped
-- Detecting CUDA compile features
-- Detecting CUDA compile features - done
-- Performing Test CMAKE_HAVE_LIBC_PTHREAD
-- Performing Test CMAKE_HAVE_LIBC_PTHREAD - Success
-- Found Threads: TRUE
-- Found CUDA: /usr/local/cuda (found version "12.1")
-- cuda include dirs:/usr/local/cuda/include, ref_cublas.cu
-- Configuring done (2.3s)
-- Generating done (0.0s)
-- Build files have been written to: /root/haojiachen/code/Cuda_Learn/GEMM/build

cmake -DK_VERSION='2' -DREF_TYPE='cublas' -DDATA_TYPE='fp16' -DSOURCE_FILE=gemm_v2.cu -B 'build' .
[ 16%] Building CUDA object CMakeFiles/cudaMatMul.dir/include/d_helper.cu.o
[ 33%] Building CUDA object CMakeFiles/cudaMatMul.dir/ref/ref_cublas.cu.o
[ 50%] Building CUDA object CMakeFiles/cudaMatMul.dir/src/fp16/gemm_v2.cu.o
[ 66%] Linking CUDA static library libcudaMatMul.a
[ 66%] Built target cudaMatMul
[ 83%] Building CUDA object CMakeFiles/main.dir/main.cu.o
[100%] Linking CUDA executable main
[100%] Built target main

init host matirx done
device name:NVIDIA A100-SXM4-80GB

Cublas Execute time:0.617810ms
Cublas Throuphput:222.461543TFLOPS

Mismatch, row:0, col: 1474, expected:1036, got:1035
Mismatch, row:0, col: 1475, expected:1025, got:1024
Mismatch, row:0, col: 1476, expected:1017, got:1017.5
Mismatch, row:0, col: 1477, expected:1016, got:1016.5
Mismatch, row:0, col: 1478, expected:1025, got:1024
Mismatch, row:0, col: 1479, expected:1022, got:1022.5
Mismatch, row:0, col: 1480, expected:1012, got:1011
Mismatch, row:0, col: 1481, expected:1039, got:1038
Mismatch, row:0, col: 1482, expected:1009, got:1009.5
Mismatch, row:0, col: 1484, expected:1037, got:1036
Mismatch, row:0, col: 1487, expected:1017, got:1017.5
Mismatch, row:0, col: 1488, expected:1023.5, got:1023
Mismatch, row:0, col: 1490, expected:1022.5, got:1021.5
Mismatch, row:0, col: 1491, expected:1015, got:1014
Mismatch, row:0, col: 1493, expected:1010.5, got:1011
Mismatch, row:0, col: 1495, expected:1020, got:1020.5
Mismatch, row:0, col: 1498, expected:1024, got:1023
Mismatch, row:0, col: 1499, expected:1015.5, got:1015
Mismatch, row:0, col: 1503, expected:998.5, got:998
Mismatch, row:0, col: 1504, expected:1022.5, got:1022
Mismatch, row:0, col: 1506, expected:1015.5, got:1015
Mismatch, row:0, col: 1509, expected:1027, got:1028
Mismatch, row:0, col: 1510, expected:1021.5, got:1021
Mismatch, row:0, col: 1513, expected:1015, got:1015.5
Mismatch, row:0, col: 1515, expected:1017, got:1016.5
Mismatch, row:0, col: 1516, expected:1036, got:1035
Mismatch, row:0, col: 1522, expected:1012.5, got:1011.5
Mismatch, row:0, col: 1523, expected:1001.5, got:1002
Mismatch, row:0, col: 1525, expected:1029, got:1028
Mismatch, row:0, col: 1527, expected:999.5, got:999
Mismatch, row:0, col: 1530, expected:1007, got:1006
Mismatch, row:0, col: 1531, expected:1038, got:1037
Mismatch, row:0, col: 1532, expected:1015.5, got:1015
Mismatch, row:0, col: 1535, expected:1016.5, got:1016
Mismatch, row:1, col: 1472, expected:1056, got:1057
Mismatch, row:1, col: 1473, expected:1043, got:1045
Mismatch, row:1, col: 1474, expected:1037, got:1039
Mismatch, row:1, col: 1475, expected:1038, got:1040
Mismatch, row:1, col: 1476, expected:1035, got:1036
Mismatch, row:1, col: 1477, expected:1036, got:1037
Mismatch, row:1, col: 1478, expected:1052, got:1054
Mismatch, row:1, col: 1480, expected:1036, got:1037
Mismatch, row:1, col: 1481, expected:1051, got:1053
Mismatch, row:1, col: 1482, expected:1021.5, got:1023.5
Mismatch, row:1, col: 1483, expected:1049, got:1050
Mismatch, row:1, col: 1484, expected:1036, got:1038
Mismatch, row:1, col: 1485, expected:1024, got:1025
Mismatch, row:1, col: 1486, expected:1042, got:1043
Mismatch, row:1, col: 1487, expected:1034, got:1036
Mismatch, row:1, col: 1488, expected:1043, got:1044
total mismatch:50

average error:9.27694e-06

compare fail!

Execute time:2.53775ms
Throuphput:54.1578TFLOPS

